<nz-modal [(nzVisible)]="isVisible" nzTitle="Vakansiyaya müraciət" (nzOnCancel)="handleCancel()">
  <div *nzModalContent>
    <nz-steps [nzCurrent]="currentStep" nzSize="small">
      <nz-step nzTitle="Şəxsi məlumatlar"></nz-step>
      <nz-step nzTitle="İmtahan"></nz-step>
      <nz-step nzTitle="Cv Yükləmək"></nz-step>
    </nz-steps>

    <ng-container [ngSwitch]="currentStep">
      <div class="stepForm" *ngSwitchCase="0">
        <form [formGroup]="myForm" (ngSubmit)="nextStep()">
          <div class="form-group">
            <label>
              Ad Soyad:
            </label>
            <input type="text" formControlName="fullName" name="fullName" placeholder="Ad və soyad daxil edin"
              [(ngModel)]="userData.fullName" required />
            <small *ngIf="myForm.controls['fullName'].invalid && myForm.controls['fullName'].touched">
              Ad və Soyad daxil edin
            </small>
          </div>
          <div class="form-group">
            <label>
              Email:

            </label>
            <input type="email" formControlName="email" name="email" placeholder="Email daxil edin"
              [(ngModel)]="userData.email" required />
            <small *ngIf="myForm.controls['email'].invalid && myForm.controls['email'].touched">
              Email daxil edin
            </small>
          </div>
          <div class="form-group">
            <label>
              Telefon:
            </label>
            <input type="tel" name="phone" formControlName="phone" appPhoneMask placeholder="(055) - 555-5555"
              [(ngModel)]="userData.phone" required />
            <small *ngIf="myForm.controls['phone'].invalid && myForm.controls['phone'].touched">
              telefon daxil edin
            </small>
          </div>
        </form>
      </div>

      <div *ngSwitchCase="1">
        <div *ngIf="!examStarted">
          <div class="exam-instructions">
            <h2>İmtahan şərtləri</h2>
            <p>İmtahan sual sayı: {{ data.length }}</p>
            <p>Hər sual üçün 1 dəqiqə vaxt verilir ümumi {{ data.length * 1 }} dəqiqə vaxtınız var</p>
            <p>Sualları seçdikdən sonra geri qayıdaraq seçdiyiniz sualı dəyişə bilmiyəcəksiniz</p>
          </div>
        </div>
        <div *ngIf="examStarted" class="quiz-card-container">
          <div class="header">
            <div>{{ questionNum + 1 }}/{{ data.length }}</div>
            <div class="timer">Time left: {{ timer }}s</div>
          </div>

          <div class="question-box">
            <h3 class="question-text">{{ data[questionNum].questionText }}</h3>
            <nz-list>
              <nz-list-item *ngFor="let option of data[questionNum].options; let index = index">
                <label class="option-label" [ngClass]="{ 'selected': isOptionSelected(index) }">
                  <input type="radio" name="question{{ questionNum }}" [disabled]="blockQuestion()" [value]="option"
                    (change)="selectAnswer(index)" [checked]="isOptionSelected(index)" />
                  <span class="option-text">{{ option }}</span>
                </label>
              </nz-list-item>
            </nz-list>
          </div>
        </div>
      </div>

      <div *ngSwitchCase="2">
        <div class="clearfix">
          <nz-upload [nzCustomRequest]="handleUpload" [nzFileList]="fileList" (nzChange)="handleChange($event)">
            <button nz-button>
              <span nz-icon nzType="upload"></span>
              CV-nizi buraya yükləyin
            </button>
          </nz-upload>
          <p>Yüklədiyiniz fayl doc, docx, PDF formatında olmaqla 5 MB-dan yuxarı ola bilməz.</p>
        </div>
        <!-- <input type="file" (change)="onFileSelected($event)"> -->
        <!-- <div class="button-row">
          <button nz-button nzType="primary" (click)="submitApplication()">Müraciəti təsdiqlə</button>
        </div> -->
      </div>
    </ng-container>
  </div>

  <div *nzModalFooter>
    <button nz-button nzType="default" (click)="prevStep()" *ngIf="currentStep ==1&& examStarted"
      [disabled]="questionNum === 0">Əvvəlki
      sual</button>
    <button nz-button nzType="primary" *ngIf="currentStep == 1&& !examStarted" (click)="startExam()">İmtahana
      başla</button>

    <button nz-button nzType="default" type="submit" (click)="nextStep()" *ngIf="currentStep ==0"
      [disabled]="myForm.invalid">Növbəti</button>
    <button nz-button nzType="default" (click)="nextQuestion()" *ngIf="currentStep ==1 && examStarted"
      [disabled]="blockQuestion()"> {{
      questionNum === data.length
      - 1 ? 'Testi Bitir' : 'Növbəti Sual' }}</button>
    <button nz-button nzType="default" (click)="submitApplication()" *ngIf="currentStep === 2"> Müraciəti
      təsdiqlə</button>
  </div>
</nz-modal>